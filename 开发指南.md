# 闲鱼自动回复系统 - 个人开发指南

## 🎯 项目概述

本项目是从原作者 [zhinianboke/xianyu-auto-reply](https://github.com/zhinianboke/xianyu-auto-reply) fork而来，采用双远程仓库策略，既能开发自己的功能，又能同步原作者的最新代码。

## 📋 仓库配置

### 远程仓库设置
- **origin**: `https://github.com/wangxin776/xianyu-auto-reply.git` (您的fork仓库)
- **upstream**: `https://github.com/zhinianboke/xianyu-auto-reply.git` (原作者仓库)

### 分支策略
- **main**: 保持与原作者同步的主分支
- **dev-my-features**: 您的功能开发分支

## 🚀 日常开发工作流

### 1. 开始新功能开发
```bash
# 确保在开发分支上
git checkout dev-my-features

# 确保是最新代码（可选，如果刚同步过）
git merge main

# 开始开发您的功能
# ... 编写代码 ...
```

### 2. 提交您的更改
```bash
# 添加更改
git add .

# 提交更改（使用有意义的提交信息）
git commit -m "添加新功能: 描述您的功能"

# 推送到您的fork仓库
git push origin dev-my-features
```

### 3. 同步原作者最新代码
```bash
# 使用提供的PowerShell脚本（推荐）
.\sync-upstream.ps1

# 或者手动执行以下命令：
git checkout main
git fetch upstream
git merge upstream/main
git push origin main
git checkout dev-my-features
git merge main
```

## 🔧 同步脚本使用

### 自动同步脚本：`sync-upstream.ps1`

**功能特性：**
- ✅ 自动检查工作区状态
- ✅ 智能检测是否有新更新
- ✅ 安全的分支切换和合并
- ✅ 彩色输出和进度提示
- ✅ 错误处理和回滚机制

**使用方法：**
```powershell
# 在项目根目录执行
.\sync-upstream.ps1
```

**注意事项：**
- 执行前请确保工作区干净（没有未提交的更改）
- 如果有冲突，脚本会提示手动解决
- 建议定期执行（如每周一次）

## 📁 推荐的开发结构

```
您的开发分支 (dev-my-features)
├── 原有功能（保持不变）
├── 您的新功能/
│   ├── my_feature_1.py
│   ├── my_feature_2.py
│   └── README_my_features.md
├── 配置修改/
│   └── my_config_changes.yml
└── 文档/
    ├── 开发指南.md (本文件)
    └── 功能说明.md
```

## 🛡️ 最佳实践

### 1. 代码管理
- **保持main分支纯净**：main分支只用于同步原作者代码，不在上面开发
- **功能分支开发**：所有个人功能都在dev-my-features分支开发
- **定期同步**：建议每周同步一次原作者的更新
- **备份重要更改**：重要功能开发完成后及时推送到远程仓库

### 2. 冲突处理
如果同步时出现冲突：
```bash
# 查看冲突文件
git status

# 手动编辑冲突文件，解决冲突标记
# 编辑完成后：
git add .
git commit -m "解决合并冲突"
```

### 3. 版本管理
- 为重要的功能版本打标签：
```bash
git tag -a v1.0-my-features -m "我的功能版本1.0"
git push origin v1.0-my-features
```

## 🔄 常用命令速查

```bash
# 查看当前分支
git branch

# 查看远程仓库
git remote -v

# 查看分支状态
git status

# 查看提交历史
git log --oneline -10

# 查看原作者是否有更新
git fetch upstream
git log --oneline main..upstream/main

# 强制推送（谨慎使用）
git push origin dev-my-features --force
```

## 📞 问题排查

### 常见问题

1. **同步脚本执行失败**
   - 检查网络连接
   - 确保工作区干净
   - 手动执行git命令排查

2. **合并冲突**
   - 仔细查看冲突文件
   - 保留需要的代码
   - 删除冲突标记

3. **推送失败**
   - 检查远程仓库权限
   - 确认分支名称正确

## 🎉 开发愉快！

现在您可以：
- ✅ 在dev-my-features分支上自由开发您的功能
- ✅ 定期同步原作者的最新代码
- ✅ 保持您的fork仓库与原仓库同步
- ✅ 不用担心提交PR的问题

祝您开发愉快！🚀
